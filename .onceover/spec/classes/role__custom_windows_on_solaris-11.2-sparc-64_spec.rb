require 'spec_helper'

describe "role::custom_windows" do

  context "using fact set solaris-11.2-sparc-64" do
    node_facts = {"aio_agent_build"=>"1.4.2", "aio_agent_version"=>"1.4.2", "architecture"=>"sun4v", "augeas"=>{"version"=>"1.4.0"}, "augeasversion"=>"1.4.0", "blockdevice_sd4_size"=>-1168154624, "blockdevice_sd4_vendor"=>"HITACHI", "blockdevice_sd5_size"=>-647710720, "blockdevice_sd5_vendor"=>"HITACHI", "blockdevice_sd6_size"=>0, "blockdevice_sd6_vendor"=>"AMI", "blockdevice_sd7_size"=>0, "blockdevice_sd7_vendor"=>"TEAC", "blockdevice_sd8_size"=>-1168154624, "blockdevice_sd8_vendor"=>"HITACHI", "blockdevice_sd9_size"=>-647710720, "blockdevice_sd9_vendor"=>"HITACHI", "blockdevices"=>"sd4,sd5,sd8,sd9,sd7,sd6", "custom_auth_conf"=>false, "dhcp_servers"=>{"net0"=>"10.32.22.10", "system"=>"10.32.22.10"}, "disks"=>{"sd4"=>{"product"=>"H109060SESUN600GRevision", "size"=>"558.91 GiB", "size_bytes"=>-1168154624, "vendor"=>"HITACHI"}, "sd5"=>{"product"=>"H109030SESUN300GRevision", "size"=>"279.40 GiB", "size_bytes"=>-647710720, "vendor"=>"HITACHI"}, "sd6"=>{"product"=>"Virtual CDROM   Revision", "size"=>"0 bytes", "size_bytes"=>0, "vendor"=>"AMI"}, "sd7"=>{"product"=>"DV-W28SS-W      Revision", "size"=>"0 bytes", "size_bytes"=>0, "vendor"=>"TEAC"}, "sd8"=>{"product"=>"H109060SESUN600GRevision", "size"=>"558.91 GiB", "size_bytes"=>-1168154624, "vendor"=>"HITACHI"}, "sd9"=>{"product"=>"H109030SESUN300GRevision", "size"=>"279.40 GiB", "size_bytes"=>-647710720, "vendor"=>"HITACHI"}}, "dmi"=>{"manufacturer"=>"Oracle Corporation"}, "domain"=>"puppet.example", "facterversion"=>"3.1.6", "fqdn"=>"solaris-11_2-sparc-t4-64.puppet.example", "gid"=>"root", "hardwareisa"=>"sparc", "hardwaremodel"=>"sun4v", "hostname"=>"solaris-11_2-sparc-t4-64", "id"=>"root", "identity"=>{"gid"=>0, "group"=>"root", "uid"=>0, "user"=>"root"}, "interfaces"=>"lo0,net0", "ipaddress"=>"10.32.77.68", "ipaddress_lo0"=>"127.0.0.1", "ipaddress_net0"=>"10.32.77.68", "is_pe"=>false, "is_virtual"=>true, "kernel"=>"SunOS", "kernelmajversion"=>"11", "kernelrelease"=>"5.11", "kernelversion"=>"11.2", "load_averages"=>{"15m"=>1.0234375, "1m"=>1.21875, "5m"=>1.28125}, "macaddress"=>"02:08:20:41:26:8c", "macaddress_net0"=>"02:08:20:41:26:8c", "manufacturer"=>"Oracle Corporation", "memory"=>{"swap"=>{"available"=>"4.00 GiB", "available_bytes"=>-8192, "capacity"=>"0%", "total"=>"4.00 GiB", "total_bytes"=>-8192, "used"=>"0 bytes", "used_bytes"=>0}, "system"=>{"available"=>"2.34 GiB", "available_bytes"=>-1777401856, "capacity"=>"84.80%", "total"=>"15.43 GiB", "total_bytes"=>-611737600, "used"=>"13.09 GiB", "used_bytes"=>1165664256}}, "memoryfree"=>"2.34 GiB", "memoryfree_mb"=>2400.9375, "memorysize"=>"15.43 GiB", "memorysize_mb"=>15800.6015625, "mountpoints"=>{"/"=>{"available"=>"475.29 GiB", "available_bytes"=>-757564928, "capacity"=>"0.18%", "device"=>"rpool/ROOT/solaris-0", "filesystem"=>"zfs", "options"=>["rw", "nodevices", "setuid", "nonbmand", "exec", "rstchown", "xattr", "atime", "mountpoint=/zones/cisparc/root/", "zone=cisparc", "nozonemod", "sharezone=38", "dev=495017b"], "size"=>"476.16 GiB", "size_bytes"=>175171072, "used"=>"889.53 MiB", "used_bytes"=>932736000}, "/dev"=>{"available"=>"0 bytes", "available_bytes"=>0, "capacity"=>"100%", "device"=>"/dev", "filesystem"=>"dev", "options"=>["zone=cisparc", "nozonemod", "sharezone=38", "dev=8e0001c"], "size"=>"0 bytes", "size_bytes"=>0, "used"=>"0 bytes", "used_bytes"=>0}, "/dev/fd"=>{"available"=>"0 bytes", "available_bytes"=>0, "capacity"=>"100%", "device"=>"fd", "filesystem"=>"fd", "options"=>["rw", "nodevices", "rstchown", "zone=cisparc", "sharezone=38", "dev=9040027"], "size"=>"0 bytes", "size_bytes"=>0, "used"=>"0 bytes", "used_bytes"=>0}, "/etc/dfs/sharetab"=>{"available"=>"0 bytes", "available_bytes"=>0, "capacity"=>"100%", "device"=>"sharefs", "filesystem"=>"sharefs", "options"=>["nodevices", "rstchown", "zone=cisparc", "sharezone=38", "dev=8f40016"], "size"=>"0 bytes", "size_bytes"=>0, "used"=>"0 bytes", "used_bytes"=>0}, "/etc/mnttab"=>{"available"=>"0 bytes", "available_bytes"=>0, "capacity"=>"100%", "device"=>"mnttab", "filesystem"=>"mntfs", "options"=>["nodevices", "rstchown", "zone=cisparc", "sharezone=38", "dev=8e80027"], "size"=>"0 bytes", "size_bytes"=>0, "used"=>"0 bytes", "used_bytes"=>0}, "/export"=>{"available"=>"475.29 GiB", "available_bytes"=>-757564928, "capacity"=>"0.00%", "device"=>"rpool/export", "filesystem"=>"zfs", "options"=>["rw", "nodevices", "setuid", "nonbmand", "exec", "rstchown", "xattr", "atime", "zone=cisparc", "sharezone=38", "dev=495017f"], "size"=>"475.29 GiB", "size_bytes"=>-757532160, "used"=>"32.00 KiB", "used_bytes"=>32768}, "/export/home"=>{"available"=>"475.29 GiB", "available_bytes"=>-757564928, "capacity"=>"0.00%", "device"=>"rpool/export/home", "filesystem"=>"zfs", "options"=>["rw", "nodevices", "setuid", "nonbmand", "exec", "rstchown", "xattr", "atime", "zone=cisparc", "sharezone=38", "dev=4950180"], "size"=>"475.29 GiB", "size_bytes"=>-757533184, "used"=>"31.00 KiB", "used_bytes"=>31744}, "/proc"=>{"available"=>"0 bytes", "available_bytes"=>0, "capacity"=>"100%", "device"=>"proc", "filesystem"=>"proc", "options"=>["nodevices", "rstchown", "zone=cisparc", "sharezone=38", "dev=8dc0026"], "size"=>"0 bytes", "size_bytes"=>0, "used"=>"0 bytes", "used_bytes"=>0}, "/rpool"=>{"available"=>"475.29 GiB", "available_bytes"=>-757564928, "capacity"=>"0.00%", "device"=>"rpool", "filesystem"=>"zfs", "options"=>["rw", "nodevices", "setuid", "nonbmand", "exec", "rstchown", "xattr", "atime", "zone=cisparc", "sharezone=38", "dev=4950181"], "size"=>"475.29 GiB", "size_bytes"=>-757533184, "used"=>"31.00 KiB", "used_bytes"=>31744}, "/system/contract"=>{"available"=>"0 bytes", "available_bytes"=>0, "capacity"=>"100%", "device"=>"ctfs", "filesystem"=>"ctfs", "options"=>["nodevices", "rstchown", "zone=cisparc", "sharezone=38", "dev=8e40027"], "size"=>"0 bytes", "size_bytes"=>0, "used"=>"0 bytes", "used_bytes"=>0}, "/system/object"=>{"available"=>"0 bytes", "available_bytes"=>0, "capacity"=>"100%", "device"=>"objfs", "filesystem"=>"objfs", "options"=>["nodevices", "rstchown", "zone=cisparc", "sharezone=38", "dev=8f00027"], "size"=>"0 bytes", "size_bytes"=>0, "used"=>"0 bytes", "used_bytes"=>0}, "/system/volatile"=>{"available"=>"4.53 GiB", "available_bytes"=>571752448, "capacity"=>"0.01%", "device"=>"swap", "filesystem"=>"tmpfs", "options"=>["nodevices", "rstchown", "xattr", "zone=cisparc", "sharezone=38", "dev=8ec004d"], "size"=>"4.53 GiB", "size_bytes"=>572342272, "used"=>"576.00 KiB", "used_bytes"=>589824}, "/tmp"=>{"available"=>"4.53 GiB", "available_bytes"=>571752448, "capacity"=>"0.95%", "device"=>"swap", "filesystem"=>"tmpfs", "options"=>["nodevices", "rstchown", "xattr", "zone=cisparc", "sharezone=38", "dev=8ec004e"], "size"=>"4.58 GiB", "size_bytes"=>618414080, "used"=>"44.50 MiB", "used_bytes"=>46661632}, "/var"=>{"available"=>"475.29 GiB", "available_bytes"=>-757564928, "capacity"=>"0.05%", "device"=>"rpool/ROOT/solaris-0/var", "filesystem"=>"zfs", "options"=>["rw", "nodevices", "setuid", "nonbmand", "exec", "rstchown", "xattr", "atime", "mountpoint=/zones/cisparc/root/var", "zone=cisparc", "nozonemod", "sharezone=38", "dev=495017d"], "size"=>"475.51 GiB", "size_bytes"=>-521269760, "used"=>"225.35 MiB", "used_bytes"=>236295168}, "/var/share"=>{"available"=>"475.29 GiB", "available_bytes"=>-757564928, "capacity"=>"0.00%", "device"=>"rpool/VARSHARE", "filesystem"=>"zfs", "options"=>["rw", "nodevices", "setuid", "nonbmand", "exec", "rstchown", "xattr", "atime", "zone=cisparc", "sharezone=38", "dev=495017e"], "size"=>"475.30 GiB", "size_bytes"=>-756610048, "used"=>"932.50 KiB", "used_bytes"=>954880}, "/var/share/pkg"=>{"available"=>"475.29 GiB", "available_bytes"=>-757564928, "capacity"=>"0.00%", "device"=>"rpool/VARSHARE/pkg", "filesystem"=>"zfs", "options"=>["rw", "nodevices", "setuid", "nonbmand", "exec", "rstchown", "xattr", "atime", "zone=cisparc", "sharezone=38", "dev=4950182"], "size"=>"475.29 GiB", "size_bytes"=>-757532160, "used"=>"32.00 KiB", "used_bytes"=>32768}, "/var/share/pkg/repositories"=>{"available"=>"475.29 GiB", "available_bytes"=>-757564928, "capacity"=>"0.00%", "device"=>"rpool/VARSHARE/pkg/repositories", "filesystem"=>"zfs", "options"=>["rw", "nodevices", "setuid", "nonbmand", "exec", "rstchown", "xattr", "atime", "zone=cisparc", "sharezone=38", "dev=4950183"], "size"=>"475.29 GiB", "size_bytes"=>-757533184, "used"=>"31.00 KiB", "used_bytes"=>31744}}, "mtu_lo0"=>8232, "mtu_net0"=>1500, "netmask"=>"255.255.255.0", "netmask_lo0"=>"255.0.0.0", "netmask_net0"=>"255.255.255.0", "network"=>"10.32.77.0", "network_lo0"=>"127.0.0.0", "network_net0"=>"10.32.77.0", "networking"=>{"dhcp"=>"10.32.22.10", "domain"=>"puppet.example", "fqdn"=>"solaris-11_2-sparc-t4-64.puppet.example", "hostname"=>"solaris-11_2-sparc-t4-64", "interfaces"=>{"lo0"=>{"bindings"=>[{"address"=>"127.0.0.1", "netmask"=>"255.0.0.0", "network"=>"127.0.0.0"}], "ip"=>"127.0.0.1", "mtu"=>8232, "netmask"=>"255.0.0.0", "network"=>"127.0.0.0"}, "net0"=>{"bindings"=>[{"address"=>"10.32.77.68", "netmask"=>"255.255.255.0", "network"=>"10.32.77.0"}], "dhcp"=>"10.32.22.10", "ip"=>"10.32.77.68", "mac"=>"02:08:20:41:26:8c", "mtu"=>1500, "netmask"=>"255.255.255.0", "network"=>"10.32.77.0"}}, "ip"=>"10.32.77.68", "mac"=>"02:08:20:41:26:8c", "mtu"=>1500, "netmask"=>"255.255.255.0", "network"=>"10.32.77.0", "primary"=>"net0"}, "operatingsystem"=>"Solaris", "operatingsystemmajrelease"=>"11", "operatingsystemrelease"=>"11.2", "os"=>{"architecture"=>"sun4v", "family"=>"Solaris", "hardware"=>"sun4v", "name"=>"Solaris", "release"=>{"full"=>"11.2", "major"=>"11", "minor"=>"2"}}, "osfamily"=>"Solaris", "path"=>"PATH:/opt/puppetlabs/bin:/usr/sbin:/usr/bin:/sbin", "pe_concat_basedir"=>"/opt/puppetlabs/puppet/cache/pe_concat", "physicalprocessorcount"=>1, "platform_symlink_writable"=>true, "platform_tag"=>"solaris-11-sparc", "processor0"=>"SPARC-T4", "processor1"=>"SPARC-T4", "processor10"=>"SPARC-T4", "processor11"=>"SPARC-T4", "processor12"=>"SPARC-T4", "processor13"=>"SPARC-T4", "processor14"=>"SPARC-T4", "processor15"=>"SPARC-T4", "processor16"=>"SPARC-T4", "processor17"=>"SPARC-T4", "processor18"=>"SPARC-T4", "processor19"=>"SPARC-T4", "processor2"=>"SPARC-T4", "processor20"=>"SPARC-T4", "processor21"=>"SPARC-T4", "processor22"=>"SPARC-T4", "processor23"=>"SPARC-T4", "processor24"=>"SPARC-T4", "processor25"=>"SPARC-T4", "processor26"=>"SPARC-T4", "processor27"=>"SPARC-T4", "processor28"=>"SPARC-T4", "processor29"=>"SPARC-T4", "processor3"=>"SPARC-T4", "processor30"=>"SPARC-T4", "processor31"=>"SPARC-T4", "processor32"=>"SPARC-T4", "processor33"=>"SPARC-T4", "processor34"=>"SPARC-T4", "processor35"=>"SPARC-T4", "processor36"=>"SPARC-T4", "processor37"=>"SPARC-T4", "processor38"=>"SPARC-T4", "processor39"=>"SPARC-T4", "processor4"=>"SPARC-T4", "processor40"=>"SPARC-T4", "processor41"=>"SPARC-T4", "processor42"=>"SPARC-T4", "processor43"=>"SPARC-T4", "processor44"=>"SPARC-T4", "processor45"=>"SPARC-T4", "processor46"=>"SPARC-T4", "processor47"=>"SPARC-T4", "processor48"=>"SPARC-T4", "processor49"=>"SPARC-T4", "processor5"=>"SPARC-T4", "processor50"=>"SPARC-T4", "processor51"=>"SPARC-T4", "processor52"=>"SPARC-T4", "processor53"=>"SPARC-T4", "processor54"=>"SPARC-T4", "processor55"=>"SPARC-T4", "processor56"=>"SPARC-T4", "processor57"=>"SPARC-T4", "processor58"=>"SPARC-T4", "processor59"=>"SPARC-T4", "processor6"=>"SPARC-T4", "processor60"=>"SPARC-T4", "processor61"=>"SPARC-T4", "processor62"=>"SPARC-T4", "processor63"=>"SPARC-T4", "processor7"=>"SPARC-T4", "processor8"=>"SPARC-T4", "processor9"=>"SPARC-T4", "processorcount"=>64, "processors"=>{"count"=>64, "isa"=>"sparc", "models"=>["SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4", "SPARC-T4"], "physicalcount"=>1, "speed"=>"2.85 GHz"}, "puppet_files_dir_present"=>false, "puppetversion"=>"4.4.2", "ruby"=>{"platform"=>"sparc-solaris2.11", "sitedir"=>"/opt/puppetlabs/puppet/lib/ruby/site_ruby/2.1.0", "version"=>"2.1.8"}, "rubyplatform"=>"sparc-solaris2.11", "rubysitedir"=>"/opt/puppetlabs/puppet/lib/ruby/site_ruby/2.1.0", "rubyversion"=>"2.1.8", "solaris_zones"=>{"current"=>"cisparc", "zones"=>{"cisparc"=>{"brand"=>"solaris", "id"=>"38", "ip_type"=>"excl", "path"=>"/", "status"=>"running", "uuid"=>"9903e75b-f048-4e38-83b3-977cde7b3782"}}}, "ssh"=>{"dsa"=>{"fingerprints"=>{"sha1"=>"SSHFP 2 1 db349d276f0d3465ddf320d4f39d91349f1b576f", "sha256"=>"SSHFP 2 2 b8e58d26d36f2ce088034a1ce3be70b03ef404671f0c6ed3256152af9c9ad607"}, "key"=>"AAAAB3NzaC1kc3MAAACBAMVAhiKM1nrem5tlbgwagi6NKV1e6RIpLxXj+vovBAb/vWf6+in2lBrxLqljbxYWq1XTOJoXUTybb24gpnDwZC2v/5TytqJ35P4ptOH1fY2zthRnkgyYUMfF7nLslOgoy24A19uwmR3lhFpklhCUe1xkMHOXkToujrfym+nwpFZ5AAAAFQDRqOSYA1u47UtVMg4zXL0txwFHIwAAAIBNxcSYfeOSQrkFawbG0GQpSNs2Z/iqFDbJFz/Ha1xkitkpmBBNizRva5tqNR8uaK/VHoIdaK7Rn1qS/D2Sl3w4Ps4UhEN9qOOylQplUmqb4JAFtAFInDMIHz/69SYMyBJ9eXQHh8mOeLX8s2lQow+Z/iOVpAlGIB0PxrHClqSN5AAAAIEAqHqE/Ry0hL98YpXRvMw0kpMl439iXQjzfx3IgJzSScNpNx3G5QDDysSu8dzanOvqXxJ0ynwc1LxuXhuvq4hJ990snyYLOgNOOJ5v86G1TkXTq3Ny0gb+7efiwI7u4xIY6WrQeXt32hbRY0kF/MswmKjz3NSBK6jozSNwHlP6jeA="}, "rsa"=>{"fingerprints"=>{"sha1"=>"SSHFP 1 1 865be76b66792c0d98006a6ed5227f19f8241cf3", "sha256"=>"SSHFP 1 2 c74d9f97237b06070909f30fbb68afbe0943450a8ea3d1b85fb16db53441a824"}, "key"=>"AAAAB3NzaC1yc2EAAAABIwAAAQEA8bZpHkHvgZEBhn7qlupS61DjwXYOnTVFuaOaDI6eesXxU1yDJfEqO1eHp6YF6x5gmM/mDyfFU9hixMmH9yLRgi2/QUhoYa44z8NB3EBaHxFtLQLnoFTGq/VR5xZ+pyBcbwUswvDel3OfXTcepmT6lWLCBRLOfYTc6hzwRCfyrWgdVc3kruu9hh9pKIWFEyUUztHWuR7+akNH3nD+EcqsmuMowEzzssWC8msWnAX89geFPuhilAgz7Qcc1bJZUaWGgOzyaZKn3IVNNa3grOWzgKDE6gdLMefnk0dgndtIbB1E9iY1syosQCrBIiEfMMGEBjrDstcNKs+Ge8stRljjMw=="}}, "sshdsakey"=>"AAAAB3NzaC1kc3MAAACBAMVAhiKM1nrem5tlbgwagi6NKV1e6RIpLxXj+vovBAb/vWf6+in2lBrxLqljbxYWq1XTOJoXUTybb24gpnDwZC2v/5TytqJ35P4ptOH1fY2zthRnkgyYUMfF7nLslOgoy24A19uwmR3lhFpklhCUe1xkMHOXkToujrfym+nwpFZ5AAAAFQDRqOSYA1u47UtVMg4zXL0txwFHIwAAAIBNxcSYfeOSQrkFawbG0GQpSNs2Z/iqFDbJFz/Ha1xkitkpmBBNizRva5tqNR8uaK/VHoIdaK7Rn1qS/D2Sl3w4Ps4UhEN9qOOylQplUmqb4JAFtAFInDMIHz/69SYMyBJ9eXQHh8mOeLX8s2lQow+Z/iOVpAlGIB0PxrHClqSN5AAAAIEAqHqE/Ry0hL98YpXRvMw0kpMl439iXQjzfx3IgJzSScNpNx3G5QDDysSu8dzanOvqXxJ0ynwc1LxuXhuvq4hJ990snyYLOgNOOJ5v86G1TkXTq3Ny0gb+7efiwI7u4xIY6WrQeXt32hbRY0kF/MswmKjz3NSBK6jozSNwHlP6jeA=", "sshfp_dsa"=>"SSHFP 2 1 db349d276f0d3465ddf320d4f39d91349f1b576f\nSSHFP 2 2 b8e58d26d36f2ce088034a1ce3be70b03ef404671f0c6ed3256152af9c9ad607", "sshfp_rsa"=>"SSHFP 1 1 865be76b66792c0d98006a6ed5227f19f8241cf3\nSSHFP 1 2 c74d9f97237b06070909f30fbb68afbe0943450a8ea3d1b85fb16db53441a824", "sshrsakey"=>"AAAAB3NzaC1yc2EAAAABIwAAAQEA8bZpHkHvgZEBhn7qlupS61DjwXYOnTVFuaOaDI6eesXxU1yDJfEqO1eHp6YF6x5gmM/mDyfFU9hixMmH9yLRgi2/QUhoYa44z8NB3EBaHxFtLQLnoFTGq/VR5xZ+pyBcbwUswvDel3OfXTcepmT6lWLCBRLOfYTc6hzwRCfyrWgdVc3kruu9hh9pKIWFEyUUztHWuR7+akNH3nD+EcqsmuMowEzzssWC8msWnAX89geFPuhilAgz7Qcc1bJZUaWGgOzyaZKn3IVNNa3grOWzgKDE6gdLMefnk0dgndtIbB1E9iY1syosQCrBIiEfMMGEBjrDstcNKs+Ge8stRljjMw==", "staging_http_get"=>"curl", "swapfree"=>"4.00 GiB", "swapfree_mb"=>4095.9921875, "swapsize"=>"4.00 GiB", "swapsize_mb"=>4095.9921875, "system_uptime"=>{"days"=>2, "hours"=>62, "seconds"=>225780, "uptime"=>"2 days"}, "timezone"=>"PDT", "uptime"=>"2 days", "uptime_days"=>2, "uptime_hours"=>62, "uptime_seconds"=>225780, "virtual"=>"zone", "zfs_featurenumbers"=>"1,2,3,4,5,6", "zfs_version"=>"6", "zone_cisparc_brand"=>"solaris", "zone_cisparc_id"=>"38", "zone_cisparc_iptype"=>"excl", "zone_cisparc_name"=>"cisparc", "zone_cisparc_path"=>"/", "zone_cisparc_status"=>"running", "zone_cisparc_uuid"=>"9903e75b-f048-4e38-83b3-977cde7b3782", "zonename"=>"cisparc", "zones"=>1, "zpool_featurenumbers"=>"1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35", "zpool_version"=>"35", "clientcert"=>"solaris-11_2-sparc-t4-64.puppet.example", "clientversion"=>"4.4.2", "clientnoop"=>false}
    let(:facts) { node_facts }


    before :each do
      # Curtrently there is some code within Puppet that will try to execute
      # commands when compiling a catalog even though it shouldn't. One example is
      # the groups attribute of the user resource on AIX. If we are running on
      # Windows but pretending to be UNIX this will definitely fail so we need to
      # mock it (or vice versa)
      # Details:
      # https://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/execution.rb#L191
      expected_null_file = Puppet::Util::Platform.windows? ? 'NUL' : '/dev/null'
      unless File.exist? expected_null_file
        allow(Puppet::Util::Execution).to receive(:execute).and_raise(Puppet::ExecutionFailure.new("Onceover caused this"))
      end
    end

    let(:pre_condition) {
      pp = <<-'END'
$onceover_class = 'role::custom_windows'
$onceover_node  = 'solaris-11.2-sparc-64'

# Begin user-specified pre_condition

# End user-specified pre_condition


END
    }

    it { should compile }
  end
end

